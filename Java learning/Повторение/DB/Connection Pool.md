Пул — это объект, самостоятельно обслуживающий некоторый набор соединений, не предусматривающий прямого доступа или использования. Пул выдает соединения, когда необходимо связаться с базой данных. Соединения возвращаются в пул после завершения работы. Пул может быть инициализирован с заданным числом соединений, или может наполняться по необходимости. Идеальное применение пула соединений выглядит следующим образом: код запрашивает соединение у пула (_checkout_), когда оно ему необходимо, использует его и сразу возвращает в пул (_release_). Таким образом, код не удерживает соединение, пока выполняется работа, никак с ним не связанная, что существенно повышает эффективность. Это позволяет выполнять множество различных задач с использованием одного или нескольких соединений. Если все соединения в пуле заняты, когда происходит очередной запрос (_checkout_), запрашивающей стороне обычно приходится ждать (_block_), пока соединение не освободится.

**HikariPool** — это сверхбыстрый, легковесный пул подключений к базе данных, разработанный специально для Java-приложений. **Его цель** — обеспечить максимально эффективное использование ресурсов базы данных и минимизировать задержки при выполнении запросов. **HikariCP**, как его еще называют, славится своей производительностью и стабильностью, став одним из самых популярных пулов подключений в мире Java.

Почему же HikariCP так популярен? **Во-первых**, он минималистичен, но при этом невероятно мощный. В отличие от других пулов подключений, **HikariCP** не перегружен функционалом, который вы, скорее всего, никогда не будете использовать. Вместо этого он сосредоточен на главном — скорости и надежности. **HikariCP** оптимизирует процесс создания, управления и завершения подключений, что позволяет вашему приложению работать быстрее и эффективнее.

Кроме того, **HikariCP** легко настраивается. Благодаря множеству конфигурационных параметров, вы можете адаптировать пул подключений под свои нужды, обеспечив баланс между производительностью и стабильностью. Например, вы можете управлять максимальным количеством активных подключений, задавать таймауты ожидания и контролировать время жизни подключений, что особенно важно при работе с двумя базами данных одновременно.

![[Pasted image 20250903214824.png]]

## Настройка HikariCP

При работе с **HikariPool** важно понимать, что правильная настройка этого инструмента может значительно повлиять на производительность вашего Java-приложения. Давайте разберем основные параметры, которые следует настроит:

```
hikari:
  idle-timeout: 120000
  minimum-idle: 2
  maximum-pool-size: 30
```

**1. idle-timeout**

Параметр `idle-timeout` определяет, сколько миллисекунд неактивное подключение может находиться в пуле перед тем, как оно будет закрыто. В примере указано значение `120000`, что эквивалентно 2 минутам. Это значит, что если подключение не используется в течение 2 минут, оно будет автоматически закрыто и освобождено.

**2. minimum-idle**

Параметр `minimum-idle` задает минимальное количество свободных (неактивных) подключений, которые пул всегда будет поддерживать. В нашем примере это значение равно `2`. Это означает, что пул всегда будет стараться поддерживать хотя бы 2 свободных подключения, чтобы при необходимости они были сразу доступны для использования.

**3. maximum-pool-size**

Параметр `maximum-pool-size` определяет максимальное количество подключений, которые могут быть одновременно активны в пуле. В данном примере это значение равно `30`. Этот параметр нужно тщательно настраивать в зависимости от требований вашего приложения и возможностей базы данных. Например, если вы используете PostgreSQL, где максимальное количество подключений установлено на уровне 500, значение `maximum-pool-size` должно быть настроено так, чтобы оставаться в пределах этого лимита, учитывая и другие приложения, использующие ту же базу данных.

#### Настройка HikariPool в зависимости от системы

Важно понимать, что значения этих параметров нужно выставлять самим, исходя из особенностей вашей системы и требований вашего приложения. Например, если ваше приложение имеет высокую нагрузку, возможно, потребуется увеличить `maximum-pool-size`, чтобы обеспечить достаточное количество подключений. Однако не стоит устанавливать его слишком высоким, чтобы не исчерпать лимиты подключений в базе данных и не создавать риски для других приложений, которые могут использовать те же ресурсы.

#### Возможные проблемы при неправильной настройке HikariPool

Если не настроить **HikariPool** должным образом, можно столкнуться с рядом проблем, которые могут серьезно повлиять на производительность вашего приложения. Одной из основных проблем является бесконтрольный рост количества подключений. Если `maximum-pool-size` не настроен, или установлен слишком высоким, количество подключений может начать расти бесконечно, не закрываясь своевременно. Это может привести к исчерпанию ресурсов базы данных, сбоям в работе других приложений и общему снижению производительности.

Кроме того, если не настроить параметры `idle-timeout` и `minimum-idle`, вы рискуете столкнуться с ситуацией, когда пул подключений будет переполнен неиспользуемыми, но не закрытыми подключениями, что также приведет к потере ресурсов и ухудшению отклика приложения.
